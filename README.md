# cci-tools

See command help messages for more info on flags required for each command.

## Add Opensearch Location

The add opensearch location script enables adding the `kerchunk_location` attribute to all files for a given kerchunk/zarr product. This script requires the path to a filelist, cloud format (kerchunk/zarr) and location of the remote file.

## Shell

`stac_shell`

Open a shell with the client and auth objects loaded for quick access to the STAC API

## Build CCI Collections

Builds all CCI STAC collections using the ODP Config file generated by Ambient as a template. This will update the existing STAC records with any changes from opensearch, but will not reset added links or items to the live STAC index. Be aware that any changes made to collections may not be respected, where they are overridden by opensearch.

## Delete Collections

`delete_collections`

Delete collections, items or nested collections from the STAC index, including removing links in the parent collection if provided. This means the STAC index is not cluttered with non-existent collections where a parent collection doesn't know a child collection has been deleted.

## Update Collection

`update_collection`

Upload/replace a collection in the STAC index from a local file. This includes merging the sets of `links` so as not to break parent-child relations.

## Create Items

`create_items`

Create CCI STAC items, requires a CCI directory relating to a set of Opensearch files. Additional parameters can be applied (see help)

## Post Items

`post_items`

Post created items to the STAC API. Requires the directory of saved STAC records.

# OpenEO Datasets - Process for creating a dataset.

OpenEO datasets are created using `cci_tools/create_openeo_collection.py` from a template file. This requires a DRS argument, a `uuid` parameter and a `formats` parameter to be supplied to the keywords. This will fill the new openeo dataset record with metadata from the moles and opensearch records from the uuid. DRS-level metadata is not yet fetched from any source.

Once the collection file has been created it can be uploaded using `update_collections`, the new file name and `cci_openeo` as the parent collection.

The collection has now been established and can be filled using the `create_items` command with associated CSV inputs that govern asset splitting etc. These items are created and uploaded separately using `post_items`.